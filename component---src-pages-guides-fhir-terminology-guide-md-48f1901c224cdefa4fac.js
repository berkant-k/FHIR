(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{jIPd:function(e,t,r){"use strict";r.r(t),r.d(t,"_frontmatter",(function(){return p})),r.d(t,"default",(function(){return l}));r("tkto"),r("yXV3"),r("pNMO"),r("zKZe"),r("q1tI");var n=r("7ljp"),a=r("013z"),o=(r("qKvR"),["components"]);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p={},s={_frontmatter:p},m=a.a;function l(e){var t=e.components,r=c(e,o);return Object(n.b)(m,i({},s,r,{components:t,mdxType:"MDXLayout"}),Object(n.b)("h2",null,"Overview"),Object(n.b)("p",null,"The LinuxForHealth FHIR Server Terminology module (",Object(n.b)("a",{parentName:"p",href:"https://github.com/LinuxForHealth/FHIR/tree/main/term/fhir-term"},"fhir-term"),") provides a FHIR terminology service provider interface (SPI) and a default implementation that implements terminology services using ",Object(n.b)("inlineCode",{parentName:"p"},"CodeSystem"),", ",Object(n.b)("inlineCode",{parentName:"p"},"ValueSet"),", and ",Object(n.b)("inlineCode",{parentName:"p"},"ConceptMap")," resources that have been made available through the FHIR registry module (",Object(n.b)("a",{parentName:"p",href:"https://github.com/LinuxForHealth/FHIR/tree/main/fhir-registry"},"fhir-registry"),")."),Object(n.b)("h2",null,"FHIR Terminology Service Diagram"),Object(n.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"953px"}},"\n      ",Object(n.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"87.15277777777777%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsTAAALEwEAmpwYAAABm0lEQVQ4y5WTiW6DMBBE+f8/TBUFymUOY3OYcDt9wWmbSkmbrpAB49mdmV28y5Mwxvh+4Pu+Unqel4dnvGfgbduA5YVc19Va+yrYHR2GQYgsTdOu69Z1+1/ltu2yrCiKsqrUsqyPwdSB2LZZF2zVddM0rbUbMCFy+A/DKGXFwy7H7tc1vGmaSF+WMk0zrWvYAsYhoje96cx8fVm7zvR9j4tJkmZ5wUml9Y32OI7spkKw4hM7UsooivcdAbNxHMIwFEJEUaTrxlnjudvOwlJzmhdHnhUWfX92bCECvcPbkeyo+AYTyG7b9nA4SFnyjQ+wrVRFkMIZNs8Tr3DcPjt3A5PYmB6HWc/ngR06JPb4GhL82/2X0zT/AKOKCqeTj88k2lvV4iKXUvX9jNwPzA1MbuQFwTuyqYwK+MdJQocoiITfhsQ183j0q0qDdG5fm5IXWZb/MWHkhqfWGqn08/JaeE4DmCAI45g2xkzVq+CmqZmbPM/5DZg2XddxnJALIkwVARHX6gdgVCGPfiilsJqxxiGCmcW8MIzI9UzzB4Lm2uwWGByuAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(n.b)("picture",{parentName:"span"},"\n          ",Object(n.b)("source",{parentName:"picture",srcSet:["/FHIR/static/e22a7c38b8a4b904280e918904eb54b0/0eda2/fhir-term-service-diagram.webp 288w","/FHIR/static/e22a7c38b8a4b904280e918904eb54b0/460e2/fhir-term-service-diagram.webp 576w","/FHIR/static/e22a7c38b8a4b904280e918904eb54b0/6b7de/fhir-term-service-diagram.webp 953w"],sizes:"(max-width: 953px) 100vw, 953px",type:"image/webp"}),"\n          ",Object(n.b)("source",{parentName:"picture",srcSet:["/FHIR/static/e22a7c38b8a4b904280e918904eb54b0/7fc1e/fhir-term-service-diagram.png 288w","/FHIR/static/e22a7c38b8a4b904280e918904eb54b0/a5df1/fhir-term-service-diagram.png 576w","/FHIR/static/e22a7c38b8a4b904280e918904eb54b0/9547d/fhir-term-service-diagram.png 953w"],sizes:"(max-width: 953px) 100vw, 953px",type:"image/png"}),"\n          ",Object(n.b)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/FHIR/static/e22a7c38b8a4b904280e918904eb54b0/9547d/fhir-term-service-diagram.png",alt:"fhir-term-service-diagram.png",title:"fhir-term-service-diagram.png",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"}}),"\n        "),"\n    "),Object(n.b)("h2",null,"FHIR Terminology Service Provider Interface (SPI)"),Object(n.b)("p",null,"The FHIR Terminology Service Provider interface provides a mechanism for implementers to provide terminology capabilities via the Java ServiceLoader. The interface includes method signatures for ",Object(n.b)("inlineCode",{parentName:"p"},"closure"),", ",Object(n.b)("inlineCode",{parentName:"p"},"getConcept"),", ",Object(n.b)("inlineCode",{parentName:"p"},"getConcepts"),", ",Object(n.b)("inlineCode",{parentName:"p"},"hasConcept"),", ",Object(n.b)("inlineCode",{parentName:"p"},"hasConcepts"),", ",Object(n.b)("inlineCode",{parentName:"p"},"isSupported")," and ",Object(n.b)("inlineCode",{parentName:"p"},"subsumes"),":"),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-java"},"public interface FHIRTermServiceProvider {\n    Set<Concept> closure(CodeSystem codeSystem, Code code);\n    Map<Code, Set<Concept>> closure(CodeSystem codeSystem, Set<Code> codes);\n    Concept getConcept(CodeSystem codeSystem, Code code);\n    Set<Concept> getConcepts(CodeSystem codeSystem);\n    <R> Set<R> getConcepts(CodeSystem codeSystem, Function<Concept, ? extends R> function);\n    Set<Concept> getConcepts(CodeSystem codeSystem, List<Filter> filters);\n    <R> Set<R> getConcepts(CodeSystem codeSystem, List<Filter> filters, Function<Concept, ? extends R> function);\n    boolean hasConcept(CodeSystem codeSystem, Code code);\n    boolean hasConcepts(CodeSystem codeSystem, Set<Code> codes);\n    boolean isSupported(CodeSystem codeSystem);\n    boolean subsumes(CodeSystem codeSystem, Code codeA, Code codeB);\n}\n")),Object(n.b)("p",null,"NOTE: ",Object(n.b)("inlineCode",{parentName:"p"},"closure(CodeSystem, Set)"),", ",Object(n.b)("inlineCode",{parentName:"p"},"getConcepts(CodeSystem, Function)"),", ",Object(n.b)("inlineCode",{parentName:"p"},"getConcepts(CodeSystem, List, Function)")," and ",Object(n.b)("inlineCode",{parentName:"p"},"hasConcepts(CodeSystem, Set)")," all have default implementations in the ",Object(n.b)("inlineCode",{parentName:"p"},"FHIRTermServiceProvider")," interface."),Object(n.b)("h2",null,"Registry Terminology Service Provider Implementation"),Object(n.b)("p",null,"The default implementation of ",Object(n.b)("inlineCode",{parentName:"p"},"FHIRTermServiceProvider")," (",Object(n.b)("a",{parentName:"p",href:"https://github.com/LinuxForHealth/FHIR/blob/main/term/fhir-term/src/main/java/org/linuxforhealth/fhir/term/service/provider/RegistryTermServiceProvider.java"},"RegistryTermServiceProvider"),") leverages terminology resources (",Object(n.b)("inlineCode",{parentName:"p"},"CodeSystem"),", ",Object(n.b)("inlineCode",{parentName:"p"},"ValueSet"),", and ",Object(n.b)("inlineCode",{parentName:"p"},"ConceptMap"),") that have been made available through the FHIR registry module (",Object(n.b)("a",{parentName:"p",href:"https://github.com/LinuxForHealth/FHIR/tree/main/fhir-registry"},"fhir-registry"),"). It supports ",Object(n.b)("inlineCode",{parentName:"p"},"CodeSystem")," resources with ",Object(n.b)("em",{parentName:"p"},"complete")," content (",Object(n.b)("inlineCode",{parentName:"p"},"CodeSystem.content = 'complete'"),") and ",Object(n.b)("inlineCode",{parentName:"p"},"ValueSet")," resources that reference ",Object(n.b)("inlineCode",{parentName:"p"},"CodeSystem")," resources that have complete content."),Object(n.b)("h2",null,"FHIR Terminology Service Singleton Facade"),Object(n.b)("p",null,"The FHIR Terminology Service Singleton facade (",Object(n.b)("a",{parentName:"p",href:"https://github.com/LinuxForHealth/FHIR/blob/main/term/fhir-term/src/main/java/org/linuxforhealth/fhir/term/service/FHIRTermService.java"},"FHIRTermService"),") loads a list of ",Object(n.b)("inlineCode",{parentName:"p"},"FHIRTermServiceProvider")," instances from the ServiceLoader and includes an instance of the ",Object(n.b)("inlineCode",{parentName:"p"},"RegistryTermServiceProvider"),". Client code (Java) that requires terminology capabilities should access them via the ",Object(n.b)("inlineCode",{parentName:"p"},"FHIRTermService")," singleton facade. Here is an example:"),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-java"},'ValueSet valueSet = ValueSetSupport.getValueSet("http://example.com/fhir/ValueSet/vs1");\nCoding coding = Coding.builder()\n        .system(Uri.of("http://example.com/fhir/CodeSystem/cs1"))\n        .version(string("1.0.0"))\n        .code(Code.of("a")\n        .display(string("concept a")\n        .build();\nValidationOutcome outcome = FHIRTermService.getInstance().validateCode(valueSet, coding);\n')),Object(n.b)("p",null,"The ",Object(n.b)("inlineCode",{parentName:"p"},"expand "),", ",Object(n.b)("inlineCode",{parentName:"p"},"lookup"),", ",Object(n.b)("inlineCode",{parentName:"p"},"validateCode")," (CodeSystem), ",Object(n.b)("inlineCode",{parentName:"p"},"validateCode")," (ValueSet), and ",Object(n.b)("inlineCode",{parentName:"p"},"translate")," methods support the passing of optional parameters (e.g. ",Object(n.b)("inlineCode",{parentName:"p"},"ExpansionParameters"),", ",Object(n.b)("inlineCode",{parentName:"p"},"LookupParameters"),", etc.). Many of the methods also return an “outcome” object. These “parameter” and “outcome” objects are modeled after the input/output parameters specified in the terminology operations from the FHIR Terminology module: ",Object(n.b)("a",{parentName:"p",href:"http://hl7.org/fhir/terminology-module.html"},"http://hl7.org/fhir/terminology-module.html"),"."),Object(n.b)("p",null,"The “parameter” objects can be created from a ",Object(n.b)("inlineCode",{parentName:"p"},"Parameters")," resource:"),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-java"},"Parameters parameters = ...;\nExpansionParameters expansionParameters = ExpansionParameters.from(parameters);\n")),Object(n.b)("p",null,"The “outcome” objects can be converted to a Parameters resource:"),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-java"},"LookupOutcome outcome = ...;\nParameters parameters = outcome.toParameters();\n")),Object(n.b)("p",null,"NOTE: The current implementation of ",Object(n.b)("inlineCode",{parentName:"p"},"FHIRTermService")," does not support optional parameters (e.g. ",Object(n.b)("inlineCode",{parentName:"p"},"ExpansionParameters"),", ",Object(n.b)("inlineCode",{parentName:"p"},"TranslationParameters"),", ",Object(n.b)("inlineCode",{parentName:"p"},"ValidationParameters"),", etc.)."),Object(n.b)("h2",null,"FHIR Server Terminology Extended Operations"),Object(n.b)("p",null,"The FHIR terminology operations module (",Object(n.b)("a",{parentName:"p",href:"https://github.com/LinuxForHealth/FHIR/tree/main/term/operation/fhir-operation-term"},"fhir-operation-term"),") connects the FHIR Server REST layer to the FHIR terminology module via the operations framework. This module implements the terminology operations as defined in the FHIR terminology service specification ",Object(n.b)("a",{parentName:"p",href:"http://hl7.org/fhir/terminology-service.html"},"http://hl7.org/fhir/terminology-service.html"),". One exception is the ",Object(n.b)("inlineCode",{parentName:"p"},"$closure")," operation. The ",Object(n.b)("inlineCode",{parentName:"p"},"$closure")," operation is experimental and does not support versioning or replay. This means that the ",Object(n.b)("inlineCode",{parentName:"p"},"$closure")," operation will always return the set of closure table entries for the given input concepts and does not store client state."),Object(n.b)("h2",null,"FHIRPath Terminology Functions"),Object(n.b)("p",null,"The FHIRPath module (",Object(n.b)("a",{parentName:"p",href:"https://github.com/LinuxForHealth/FHIR/tree/main/fhir-path"},"fhir-path"),") has been updated to support implementations of the draft FHIRPath terminology function specification: ",Object(n.b)("a",{parentName:"p",href:"http://hl7.org/fhir/fhirpath.html#txapi"},"http://hl7.org/fhir/fhirpath.html#txapi"),". Support for the following functions (accessed through the ",Object(n.b)("inlineCode",{parentName:"p"},"%terminologies")," constant) has been implemented:"),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre"},"%terminologies.expand(valueSet, params) : ValueSet\n%terminologies.lookup(coded, params) : Parameters\n%terminologies.validateVS(valueSet, coded, params) : Parameters\n%terminologies.validateCS(codeSystem, coded, params) : Parameters\n%terminologies.subsumes(system, coded1, coded2, params) : code\n%terminologies.translate(conceptMap, code, params) : Parameters\n")),Object(n.b)("p",null,"Here is the same example from above but going through the FHIRPath evaluator:"),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-java"},'Coding coding = Coding.builder()\n        .system(Uri.of("http://example.com/fhir/CodeSystem/cs1"))\n        .version(string("1.0.0"))\n        .code(Code.of("a")\n        .display(string("concept a")\n        .build();\nCollection<FHIRPathNode> initialContext = singleton(FHIRPathElementNode.elementNode(coding));\nFHIRPathEvaluator evaluator = FHIRPathEvaluator.evaluator();\nCollection<FHIRPathNode> result = evaluator.evaluate("%terminologies.validateCode(\'http://example.com/fhir/ValueSet/vs1\', %context)");\n')),Object(n.b)("p",null,"Additionally, the FHIRPath functions ",Object(n.b)("inlineCode",{parentName:"p"},"subsumedBy")," and ",Object(n.b)("inlineCode",{parentName:"p"},"subsumes")," have been implemented per: ",Object(n.b)("a",{parentName:"p",href:"http://hl7.org/fhir/fhirpath.html#functions"},"http://hl7.org/fhir/fhirpath.html#functions")),Object(n.b)("h2",null,"Graph Terminology Service Provider Implementation (experimental)"),Object(n.b)("p",null,"The FHIR term graph module ",Object(n.b)("a",{parentName:"p",href:"https://github.com/LinuxForHealth/FHIR/tree/main/term/fhir-term-graph"},"fhir-term-graph")," provides an implementation of ",Object(n.b)("inlineCode",{parentName:"p"},"FHIRTermServiceProvider")," that is backed by a graph database (",Object(n.b)("a",{parentName:"p",href:"https://janusgraph.org"},"JanusGraph"),"). The module also contains term graph loaders for SNOMED-CT Release Format 2 (RF2) files (SnomedTermGraphLoader), UMLS Rich Release Format (RRF) files (UMLSTermGraphLoader), and FHIR CodeSystem resources (CodeSystemTermGraphLoader). Graph term service providers may be enabled / configured through the ",Object(n.b)("inlineCode",{parentName:"p"},"fhir-server-config.json")," file per the configuration properties specified in the ",Object(n.b)("a",{parentName:"p",href:"https://linuxforhealth.github.io/FHIR/guides/FHIRServerUsersGuide#51-configuration-properties-reference"},"FHIR Server User’s Guide"),"."),Object(n.b)("p",null,"Example configurations:"),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-json"},'            "graphTermServiceProviders": [{\n                "__comment": "Configuration for Berkeley DB Java Edition + Lucene",\n                "enabled": false,\n                "configuration": {\n                    "storage.backend": "berkeleyje",\n                    "storage.directory": "data/graph",\n                    "index.search.backend": "lucene",\n                    "index.search.hostname": "data/searchindex",\n                    "storage.read-only": true,\n                    "query.batch": true,\n                    "query.batch-property-prefetch": true,\n                    "query.fast-property": true\n                }\n            },{\n                "__comment": "Configuration for Apache Cassandra + ElasticSearch",\n                "enabled": true,\n                "timeLimit": 10000,\n                "configuration": {\n                    "storage.backend": "cql",\n                    "storage.hostname": "127.0.0.1",\n                    "index.search.backend": "elasticsearch",\n                    "index.search.hostname": "127.0.0.1:9200",\n                    "storage.read-only": true,\n                    "query.batch": true,\n                    "query.batch-property-prefetch": true,\n                    "query.fast-property": true\n                }\n            }],\n')),Object(n.b)("h2",null,"Remote Terminology Service Provider Implementation (experimental)"),Object(n.b)("p",null,"The FHIR term remote module ",Object(n.b)("a",{parentName:"p",href:"https://github.com/LinuxForHealth/FHIR/tree/main/term/fhir-term-remote"},"fhir-term-remote")," provides an implementation of ",Object(n.b)("inlineCode",{parentName:"p"},"FHIRTermServiceProvider")," that connects to an external service using a REST client to access code system content. The external service must implement the FHIR REST terminology APIs documented ",Object(n.b)("a",{parentName:"p",href:"http://hl7.org/fhir/terminology-service.html"},"here"),". Remote term service providers may be enabled / configured through the ",Object(n.b)("inlineCode",{parentName:"p"},"fhir-server-config.json")," file per the configuration properties specified in the ",Object(n.b)("a",{parentName:"p",href:"https://linuxforhealth.github.io/FHIR/guides/FHIRServerUsersGuide#51-configuration-properties-reference"},"FHIR Server User’s Guide"),"."),Object(n.b)("p",null,"Example configurations:"),Object(n.b)("pre",null,Object(n.b)("code",{parentName:"pre",className:"language-json"},'            "remoteTermServiceProviders": [{\n                "__comment": "Configuration for public SNOMED-CT endpoint",\n                "enabled": true,\n                "base": "https://snowstorm-fhir.snomedtools.org/fhir",\n                "supports": [{\n                    "system": "http://snomed.info/sct"\n                }]\n            },{\n                "__comment": "Configuration for public LOINC endpoint",\n                "enabled": true,\n                "base": "https://fhir.loinc.org",\n                "basicAuth": {\n                    "username": "loincUsername",\n                    "password": "loincPassword"\n                \n                },\n                "supports": [{\n                    "system": "http://loinc.org"\n                }]\n            }]\n')))}l.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-fhir-terminology-guide-md-48f1901c224cdefa4fac.js.map